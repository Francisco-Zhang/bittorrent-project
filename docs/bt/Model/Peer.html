<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_25) on Sat Jul 13 20:30:46 EDT 2013 -->
<title>Peer</title>
<meta name="date" content="2013-07-13">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Peer";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../bt/Model/Bittorrent.html" title="class in bt.Model"><span class="strong">Prev Class</span></a></li>
<li><a href="../../bt/Model/PeerListener.html" title="class in bt.Model"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?bt/Model/Peer.html" target="_top">Frames</a></li>
<li><a href="Peer.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">bt.Model</div>
<h2 title="Class Peer" class="title">Class Peer</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>bt.Model.Peer</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.lang.Runnable</dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">Peer</span>
extends java.lang.Object
implements java.lang.Runnable</pre>
<div class="block">Creates a connection with a peer to download a file.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean[]</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#bitField">bitField</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#choked">choked</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#clientID">clientID</a></strong></code>
<div class="block">This field, clientID, holds the 20 byte peer id of the client which instantiated this object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean[]</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#completed">completed</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.net.Socket</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#dataSocket">dataSocket</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private byte[][]</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#fileHeap">fileHeap</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#handShakeResponse">handShakeResponse</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#hash">hash</a></strong></code>
<div class="block">This field, hash, holds the 20 byte info_hash of the .Torrent file being used by the client which
 instantiated this object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.io.InputStream</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#in">in</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#interested">interested</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Queue&lt;<a href="../../bt/Model/Request.html" title="class in bt.Model">Request</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#interestedQueue">interestedQueue</a></strong></code>
<div class="block">interestedQueue is a maintained list of the piece requests a particular peer has made to this client.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#IP">IP</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../bt/Model/PeerListener.html" title="class in bt.Model">PeerListener</a></code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#listener">listener</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.io.OutputStream</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#out">out</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#peerAccepted">peerAccepted</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#port">port</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#running">running</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.security.MessageDigest</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#sha">sha</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Date</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#timeout">timeout</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private byte[][]</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#verifyHash">verifyHash</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../bt/Model/Peer.html#Peer()">Peer</a></strong>()</code>
<div class="block">Default constructor used for testing from CommandParser interface</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../bt/Model/Peer.html#Peer(java.lang.String, int, byte[], byte[], byte[][], byte[][], boolean[])">Peer</a></strong>(java.lang.String&nbsp;address,
    int&nbsp;port,
    byte[]&nbsp;hashIn,
    byte[]&nbsp;peerID,
    byte[][]&nbsp;heapReference,
    byte[][]&nbsp;verifyReference,
    boolean[]&nbsp;completedReference)</code>
<div class="block">This is a constructor for a Peer taking the address and port as parameters.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#cancelIndex(int, int, int)">cancelIndex</a></strong>(int&nbsp;index,
           int&nbsp;begin,
           int&nbsp;length)</code>
<div class="block">This method sends a cancel message to the peer this object represents.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#choke()">choke</a></strong>()</code>
<div class="block">Sends a message to the peer this object represents that it has been choked.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#dispose()">dispose</a></strong>()</code>
<div class="block">This method can be called before removing the last reference to this object to clear system
 resources and heap memory.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#getPiece(int, int, byte[])">getPiece</a></strong>(int&nbsp;index,
        int&nbsp;begin,
        byte[]&nbsp;payload)</code>
<div class="block">This method is called by the PeerListener child of this object when a piece of the file is received
 from the peer this object represents.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#handShake()">handShake</a></strong>()</code>
<div class="block">Performs the handshake to open connection with peer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#haveReceived(int)">haveReceived</a></strong>(int&nbsp;index)</code>
<div class="block">This method is called by the PeerListener child of this object when a have is received from
 the peer this object represents.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#keepalive()">keepalive</a></strong>()</code>
<div class="block">Sends a keep alive signal to the peer this object represents.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#receiveBitfield(byte[])">receiveBitfield</a></strong>(byte[]&nbsp;bitfield)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#requestIndex(int, int, int)">requestIndex</a></strong>(int&nbsp;index,
            int&nbsp;begin,
            int&nbsp;length)</code>
<div class="block">This method sends a request message to the peer this object represents.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#requestReceived(int, int, int)">requestReceived</a></strong>(int&nbsp;index,
               int&nbsp;begin,
               int&nbsp;length)</code>
<div class="block">This method is called by the PeerListener child of this object when a request is received from
 the peer this object represents.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#run()">run</a></strong>()</code>
<div class="block">This method spins off a listener thread to receive file pieces from the peer this object
 represents, calls for a handshake with that peer, then enters a loop in which it serves
 requested file pieces to that peer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#send(bt.Model.Request)">send</a></strong>(<a href="../../bt/Model/Request.html" title="class in bt.Model">Request</a>&nbsp;request)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#sendBitfield()">sendBitfield</a></strong>()</code>
<div class="block">This method can be used to send a bitfield to the peer this object represents.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#sendPiece(int, int, int, byte[])">sendPiece</a></strong>(int&nbsp;index,
         int&nbsp;begin,
         int&nbsp;payloadSize,
         byte[]&nbsp;payload)</code>
<div class="block">This message sends a piece of the file to the peer this object represents.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#setChoke(boolean)">setChoke</a></strong>(boolean&nbsp;value)</code>
<div class="block">Sets the choked bit flag on this peer's connection.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#setHandShakeResponse(byte[])">setHandShakeResponse</a></strong>(byte[]&nbsp;hsr)</code>
<div class="block">It sets the handshake response from the peer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#setInterested(boolean)">setInterested</a></strong>(boolean&nbsp;value)</code>
<div class="block">Sets the interested bit flag on this peer's connection.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#showFinished(int)">showFinished</a></strong>(int&nbsp;piece)</code>
<div class="block">This method will notify this client that we have successfully completed the transfer of a piece of
 the file from some peer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#showInterested()">showInterested</a></strong>()</code>
<div class="block">Sends a message to the peer this object represents we are interested in data it holds.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#showNotInterested()">showNotInterested</a></strong>()</code>
<div class="block">Sends a message to the peer this object represents that we are not interested in the data it holds.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#toString()">toString</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#unChoke()">unChoke</a></strong>()</code>
<div class="block">Sends a message to the peer this object represents that it has been unchoked.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#updateTimout()">updateTimout</a></strong>()</code>
<div class="block">When called, this method replaces timeout with a new Date object, which by default is set to
 the current date and time.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#validateInfoHash(byte[])">validateInfoHash</a></strong>(byte[]&nbsp;response)</code>
<div class="block">It does a byte match of the info_hashes.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../bt/Model/Peer.html#verifySHA(int)">verifySHA</a></strong>(int&nbsp;index)</code>
<div class="block">This method verifies that the piece of the file with the given index is complete and valid.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="fileHeap">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fileHeap</h4>
<pre>private&nbsp;byte[][] fileHeap</pre>
</li>
</ul>
<a name="verifyHash">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyHash</h4>
<pre>private&nbsp;byte[][] verifyHash</pre>
</li>
</ul>
<a name="completed">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>completed</h4>
<pre>private&nbsp;boolean[] completed</pre>
</li>
</ul>
<a name="bitField">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bitField</h4>
<pre>private&nbsp;boolean[] bitField</pre>
</li>
</ul>
<a name="listener">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>listener</h4>
<pre>private&nbsp;<a href="../../bt/Model/PeerListener.html" title="class in bt.Model">PeerListener</a> listener</pre>
</li>
</ul>
<a name="choked">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>choked</h4>
<pre>private&nbsp;boolean choked</pre>
</li>
</ul>
<a name="interested">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>interested</h4>
<pre>private&nbsp;boolean interested</pre>
</li>
</ul>
<a name="dataSocket">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dataSocket</h4>
<pre>private&nbsp;java.net.Socket dataSocket</pre>
</li>
</ul>
<a name="in">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>in</h4>
<pre>private&nbsp;java.io.InputStream in</pre>
</li>
</ul>
<a name="out">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>out</h4>
<pre>private&nbsp;java.io.OutputStream out</pre>
</li>
</ul>
<a name="sha">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sha</h4>
<pre>private&nbsp;java.security.MessageDigest sha</pre>
</li>
</ul>
<a name="running">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>running</h4>
<pre>private&nbsp;boolean running</pre>
</li>
</ul>
<a name="handShakeResponse">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handShakeResponse</h4>
<pre>private&nbsp;byte[] handShakeResponse</pre>
</li>
</ul>
<a name="peerAccepted">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>peerAccepted</h4>
<pre>public&nbsp;boolean peerAccepted</pre>
</li>
</ul>
<a name="IP">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>IP</h4>
<pre>private&nbsp;java.lang.String IP</pre>
</li>
</ul>
<a name="port">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>port</h4>
<pre>private&nbsp;int port</pre>
</li>
</ul>
<a name="timeout">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>timeout</h4>
<pre>private&nbsp;java.util.Date timeout</pre>
</li>
</ul>
<a name="hash">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hash</h4>
<pre>private&nbsp;byte[] hash</pre>
<div class="block">This field, hash, holds the 20 byte info_hash of the .Torrent file being used by the client which
 instantiated this object.</div>
</li>
</ul>
<a name="clientID">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clientID</h4>
<pre>private&nbsp;byte[] clientID</pre>
<div class="block">This field, clientID, holds the 20 byte peer id of the client which instantiated this object.</div>
</li>
</ul>
<a name="interestedQueue">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>interestedQueue</h4>
<pre>private&nbsp;java.util.Queue&lt;<a href="../../bt/Model/Request.html" title="class in bt.Model">Request</a>&gt; interestedQueue</pre>
<div class="block">interestedQueue is a maintained list of the piece requests a particular peer has made to this client.
 When there is space on the outgoing TCP queue, and the connection is not choked, the oldest value in
 this queue will be sent to the peer.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Peer(java.lang.String, int, byte[], byte[], byte[][], byte[][], boolean[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Peer</h4>
<pre>public&nbsp;Peer(java.lang.String&nbsp;address,
    int&nbsp;port,
    byte[]&nbsp;hashIn,
    byte[]&nbsp;peerID,
    byte[][]&nbsp;heapReference,
    byte[][]&nbsp;verifyReference,
    boolean[]&nbsp;completedReference)
     throws java.net.UnknownHostException,
            java.io.IOException,
            java.lang.Exception</pre>
<div class="block">This is a constructor for a Peer taking the address and port as parameters.  The address and port of a
 peer object are immutable during running, and therefore can only be set with this constructor.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>address</code> - Address of the peer this object represents.</dd><dd><code>port</code> - Port on which to contact the peer which this object represents.</dd><dd><code>hashIn</code> - This field will hold 20 byte hash of the .Torrent file being used by the client which
 instantiated this object.</dd><dd><code>peerID</code> - This field will hold the 20 byte peer id of the client which instantiated this object.</dd><dd><code>heapReference</code> - A reference to the section of the heap where the file is stored during download.</dd><dd><code>verifyReference</code> - A reference to a byte array storing the correct SHA-1 hashes of the pieces of
 the file.</dd><dd><code>completedReference</code> - A reference to a boolean array storing the completeness status of each piece
 of the file.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.net.UnknownHostException</code> - If the address cannot be resolved to a host, this exception will be thrown.</dd>
<dd><code>java.io.IOException</code> - If a connection cannot be opened to this host, this exception will be thrown.</dd>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="Peer()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Peer</h4>
<pre>public&nbsp;Peer()</pre>
<div class="block">Default constructor used for testing from CommandParser interface</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setHandShakeResponse(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setHandShakeResponse</h4>
<pre>public&nbsp;void&nbsp;setHandShakeResponse(byte[]&nbsp;hsr)</pre>
<div class="block">It sets the handshake response from the peer.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>hsr</code> - </dd></dl>
</li>
</ul>
<a name="run()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;void&nbsp;run()</pre>
<div class="block">This method spins off a listener thread to receive file pieces from the peer this object
 represents, calls for a handshake with that peer, then enters a loop in which it serves
 requested file pieces to that peer.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>run</code>&nbsp;in interface&nbsp;<code>java.lang.Runnable</code></dd>
</dl>
</li>
</ul>
<a name="updateTimout()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateTimout</h4>
<pre>void&nbsp;updateTimout()</pre>
<div class="block">When called, this method replaces timeout with a new Date object, which by default is set to
 the current date and time.</div>
</li>
</ul>
<a name="keepalive()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>keepalive</h4>
<pre>void&nbsp;keepalive()
         throws java.io.IOException</pre>
<div class="block">Sends a keep alive signal to the peer this object represents.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If the system fails to send the TCP message, this exception will be thrown.</dd></dl>
</li>
</ul>
<a name="choke()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>choke</h4>
<pre>void&nbsp;choke()
     throws java.io.IOException</pre>
<div class="block">Sends a message to the peer this object represents that it has been choked.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If the system fails to send the TCP message, this exception will be thrown.</dd></dl>
</li>
</ul>
<a name="unChoke()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unChoke</h4>
<pre>void&nbsp;unChoke()
       throws java.io.IOException</pre>
<div class="block">Sends a message to the peer this object represents that it has been unchoked.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If the system fails to send the TCP message, this exception will be thrown.</dd></dl>
</li>
</ul>
<a name="showInterested()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showInterested</h4>
<pre>void&nbsp;showInterested()
              throws java.io.IOException</pre>
<div class="block">Sends a message to the peer this object represents we are interested in data it holds.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If the system fails to send the TCP message, this exception will be thrown.</dd></dl>
</li>
</ul>
<a name="showNotInterested()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showNotInterested</h4>
<pre>void&nbsp;showNotInterested()
                 throws java.io.IOException</pre>
<div class="block">Sends a message to the peer this object represents that we are not interested in the data it holds.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If the system fails to send the TCP message, this exception will be thrown.</dd></dl>
</li>
</ul>
<a name="showFinished(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showFinished</h4>
<pre>void&nbsp;showFinished(int&nbsp;piece)
            throws java.io.IOException</pre>
<div class="block">This method will notify this client that we have successfully completed the transfer of a piece of
 the file from some peer.  The peer this object represents will therefore be able to remove this
 piece from the queue of interested pieces it is maintaining for this client.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>piece</code> - The piece of the file which has been completed.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="send(bt.Model.Request)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>send</h4>
<pre>private&nbsp;void&nbsp;send(<a href="../../bt/Model/Request.html" title="class in bt.Model">Request</a>&nbsp;request)</pre>
</li>
</ul>
<a name="sendPiece(int, int, int, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendPiece</h4>
<pre>void&nbsp;sendPiece(int&nbsp;index,
             int&nbsp;begin,
             int&nbsp;payloadSize,
             byte[]&nbsp;payload)
         throws java.io.IOException</pre>
<div class="block">This message sends a piece of the file to the peer this object represents.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - Index of this piece of the file</dd><dd><code>begin</code> - byte offset in the piece where the payload of this message begins.</dd><dd><code>payloadSize</code> - size of the payload in bytes.</dd><dd><code>payload</code> - byte array of the payload.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - will be thrown if the system is unable to dispatch the message.</dd></dl>
</li>
</ul>
<a name="getPiece(int, int, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPiece</h4>
<pre>void&nbsp;getPiece(int&nbsp;index,
            int&nbsp;begin,
            byte[]&nbsp;payload)</pre>
<div class="block">This method is called by the PeerListener child of this object when a piece of the file is received
 from the peer this object represents.  If this piece is already marked completed, we will assume that
 this peer's have message has been lost, and will resend it.  If it is not marked completed, we will
 add this data to the fileHeap and attempt to verify that the piece is complete.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - The index of this piece of the file.</dd><dd><code>begin</code> - The base zero offset from the beginning of this piece where the payload begins.</dd><dd><code>payload</code> - A byte array of the incoming data.</dd></dl>
</li>
</ul>
<a name="requestIndex(int, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>requestIndex</h4>
<pre>void&nbsp;requestIndex(int&nbsp;index,
                int&nbsp;begin,
                int&nbsp;length)
            throws java.io.IOException</pre>
<div class="block">This method sends a request message to the peer this object represents.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - piece of the file to be requested.</dd><dd><code>begin</code> - byte offset</dd><dd><code>length</code> - byte offset</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - will be thrown if the system is unable to dispatch the message.</dd></dl>
</li>
</ul>
<a name="requestReceived(int, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>requestReceived</h4>
<pre>void&nbsp;requestReceived(int&nbsp;index,
                   int&nbsp;begin,
                   int&nbsp;length)</pre>
<div class="block">This method is called by the PeerListener child of this object when a request is received from
 the peer this object represents.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - The index of the piece that the peer has requested.</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString()</pre>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>toString</code>&nbsp;in class&nbsp;<code>java.lang.Object</code></dd>
</dl>
</li>
</ul>
<a name="haveReceived(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>haveReceived</h4>
<pre>void&nbsp;haveReceived(int&nbsp;index)</pre>
<div class="block">This method is called by the PeerListener child of this object when a have is received from
 the peer this object represents.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - The index of the piece that the peer has acknowledged complete..</dd></dl>
</li>
</ul>
<a name="cancelIndex(int, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cancelIndex</h4>
<pre>void&nbsp;cancelIndex(int&nbsp;index,
               int&nbsp;begin,
               int&nbsp;length)
           throws java.io.IOException</pre>
<div class="block">This method sends a cancel message to the peer this object represents.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - piece of the file to be requested.</dd><dd><code>begin</code> - byte offset</dd><dd><code>length</code> - byte offset</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - will be thrown if the system is unable to dispatch the message.</dd></dl>
</li>
</ul>
<a name="receiveBitfield(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>receiveBitfield</h4>
<pre>void&nbsp;receiveBitfield(byte[]&nbsp;bitfield)</pre>
</li>
</ul>
<a name="sendBitfield()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendBitfield</h4>
<pre>void&nbsp;sendBitfield()
            throws java.io.IOException</pre>
<div class="block">This method can be used to send a bitfield to the peer this object represents.  This should only
 be done as the first message to this peer.  A bitfield is a byte[] with each index that the downloader,
 this client, has received set to one and the rest set to zero. Downloaders which don't have anything yet
 may skip the 'bitfield' message. The first byte of the bitfield corresponds to indices 0 - 7 from high
 bit to low bit, respectively. The next one 8-15, etc. Spare bits at the end are set to zero.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if the system fails to send the TCP packet properly, this exception will be thrown.</dd></dl>
</li>
</ul>
<a name="setInterested(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setInterested</h4>
<pre>void&nbsp;setInterested(boolean&nbsp;value)</pre>
<div class="block">Sets the interested bit flag on this peer's connection.  When a peer sets not interested we
 clear the interestedQueue.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>value</code> - Value for interested flag.</dd></dl>
</li>
</ul>
<a name="setChoke(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setChoke</h4>
<pre>void&nbsp;setChoke(boolean&nbsp;value)</pre>
<div class="block">Sets the choked bit flag on this peer's connection.  We clear the interestedQueue when we
 are choked.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>value</code> - Value for the choked flag.</dd></dl>
</li>
</ul>
<a name="handShake()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handShake</h4>
<pre>private&nbsp;void&nbsp;handShake()</pre>
<div class="block">Performs the handshake to open connection with peer.</div>
</li>
</ul>
<a name="dispose()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dispose</h4>
<pre>void&nbsp;dispose()</pre>
<div class="block">This method can be called before removing the last reference to this object to clear system
 resources and heap memory.</div>
</li>
</ul>
<a name="verifySHA(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySHA</h4>
<pre>private&nbsp;void&nbsp;verifySHA(int&nbsp;index)</pre>
<div class="block">This method verifies that the piece of the file with the given index is complete and valid.  If the
 file is complete and valid, It will be marked complete in the completed array, and a The peer will be
 sent a have message.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - The piece of the file being verified</dd></dl>
</li>
</ul>
<a name="validateInfoHash(byte[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>validateInfoHash</h4>
<pre>public&nbsp;boolean&nbsp;validateInfoHash(byte[]&nbsp;response)</pre>
<div class="block">It does a byte match of the info_hashes.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>response</code> - Response to our handshake from peer.</dd>
<dt><span class="strong">Returns:</span></dt><dd>boolean True if match, false otherwise.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../bt/Model/Bittorrent.html" title="class in bt.Model"><span class="strong">Prev Class</span></a></li>
<li><a href="../../bt/Model/PeerListener.html" title="class in bt.Model"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?bt/Model/Peer.html" target="_top">Frames</a></li>
<li><a href="Peer.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
